!function(){"use strict";angular.module("app",["ngRoute","ngCookies"]).config(["$routeProvider","$locationProvider",function(e,t){e.when("/",{templateUrl:"views/public/pages/listpage.html",controller:"listpage_controller"}).when("/bears/:id",{templateUrl:"views/public/pages/detailpage.html",controller:"detail_controller"}).when("/login",{templateUrl:"views/public/pages/login.html",controller:"login_controller"}).when("/cms",{templateUrl:"views/public/pages/cms.html",controller:"cms_controller"}).otherwise({redirectTo:"/"}),t.html5Mode(!0)}])}(),function(){"use strict";var e=function(e,t,n,r,o){e.homeTexts=[],e.detailTexts=[],e.showInput=!1;var a=t.get("m-token");a||n.path("/login"),a&&r.authenticateToken(a).then(function(e){e.success?i():e.error&&n.path(e.redirect_url)});var i=function(){o.getContentForPage(1).then(function(t){e.homeTexts=t}),o.getContentForPage(2).then(function(t){e.detailTexts=t})};e.saveText=function(e){e.id&&o.updateContentForTextId(e.id,e.text).then(function(e){console.log(e)})}};angular.module("app").controller("cms_controller",["$scope","$cookies","$location","user_service","cms_service",e])}(),function(){"use strict";var e=function(e,t){e.newBear={name:"",home:""},e.createBear=function(){e.newBear.name&&e.newBear.home&&t.create_bear(e.newBear).then(function(t){t.id&&t.name&&t.home&&(e.bears.push(t),e.newBear={name:"",home:""})})}};angular.module("app").controller("create_controller",["$scope","bear_service",e])}(),function(){"use strict";var e=function(e,t,n){n.get_bear_by_id(t.id).then(function(t){e.currentBear=t})};angular.module("app").controller("detail_controller",["$scope","$routeParams","bear_service",e])}(),function(){"use strict";var e=function(e,t,n){e.bears=[],t.get_bears().then(function(t){e.bears=t}),e.deleteBear=function(n){t.delete_bear(n.id).then(function(t){if("success"===t.msg){var r=e.bears.indexOf(n);r>-1&&e.bears.splice(r,1)}})},n.getContentForPage(1).then(function(e){$.each(e,function(e,t){$('[data-t-id="'+t.id+'"]').html(t.text)})})};angular.module("app").controller("listpage_controller",["$scope","bear_service","cms_service",e])}(),function(){"use strict";var e=function(e,t,n){e.username="marijn",e.password="12345",e.login=function(){n.login(e.username,sha256(e.password)).then(function(e){t.path(e.redirect_url)})}};angular.module("app").controller("login_controller",["$scope","$location","user_service",e])}(),function(){"use strict";var e=function(e){return{get_bears:function(){return e.get("/api/bears").then(function(e){return e.data})},get_bear_by_id:function(t){return e.get("/api/bears/"+t).then(function(e){return e.data})},create_bear:function(t){return e.post("/api/bears",t).then(function(e){return e.data})},delete_bear:function(t){return e.put("/api/bears/"+t).then(function(e){return e.data})}}};angular.module("app").factory("bear_service",["$http",e])}(),function(){"use strict";var e=function(e){return{getAllContent:function(){return e.get("/api/cms/pages").then(function(e){return e.data})},getContentForPage:function(t){return e.get("/api/cms/page/"+t).then(function(e){return e.data})},updateContentForTextId:function(t,n){return e.post("/api/cms/page/"+t,{text:n}).then(function(e){return e.data})}}};angular.module("app").factory("cms_service",["$http",e])}(),function(){"use strict";var e=function(e){return{login:function(t,n){return e.post("/api/login",{login:t,password:n}).then(function(e){return e.data})},authenticateToken:function(t){return e.post("/api/authtoken",{"m-token":t}).then(function(e){return e.data})}}};angular.module("app").factory("user_service",["$http",e])}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJvdXRlci5qcyIsImNtc19jb250cm9sbGVyLmpzIiwiY3JlYXRlX2NvbnRyb2xsZXIuanMiLCJkZXRhaWxfY29udHJvbGxlci5qcyIsImxpc3RwYWdlX2NvbnRyb2xsZXIuanMiLCJsb2dpbl9jb250cm9sbGVyLmpzIiwiYmVhcl9zZXJ2aWNlLmpzIiwiY21zX3NlcnZpY2UuanMiLCJ1c2VyX3NlcnZpY2UuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwib3RoZXJ3aXNlIiwicmVkaXJlY3RUbyIsImh0bWw1TW9kZSIsImNtc19jb250cm9sbGVyIiwiJHNjb3BlIiwiJGNvb2tpZXMiLCIkbG9jYXRpb24iLCJ1c2VyX3NlcnZpY2UiLCJjbXNfc2VydmljZSIsImhvbWVUZXh0cyIsImRldGFpbFRleHRzIiwic2hvd0lucHV0IiwidG9rZW4iLCJnZXQiLCJwYXRoIiwiYXV0aGVudGljYXRlVG9rZW4iLCJ0aGVuIiwicmVzcG9uc2UiLCJzdWNjZXNzIiwiaW5pdCIsImVycm9yIiwicmVkaXJlY3RfdXJsIiwiZ2V0Q29udGVudEZvclBhZ2UiLCJzYXZlVGV4dCIsInQiLCJpZCIsInVwZGF0ZUNvbnRlbnRGb3JUZXh0SWQiLCJ0ZXh0IiwiY29uc29sZSIsImxvZyIsImNyZWF0ZV9jb250cm9sbGVyIiwiYmVhcl9zZXJ2aWNlIiwibmV3QmVhciIsIm5hbWUiLCJob21lIiwiY3JlYXRlQmVhciIsImNyZWF0ZV9iZWFyIiwiYmVhciIsImJlYXJzIiwicHVzaCIsImRldGFpbF9jb250cm9sbGVyIiwiJHJvdXRlUGFyYW1zIiwiZ2V0X2JlYXJfYnlfaWQiLCJjdXJyZW50QmVhciIsImxpc3RwYWdlX2NvbnRyb2xsZXIiLCJnZXRfYmVhcnMiLCJkZWxldGVCZWFyIiwiZGVsZXRlX2JlYXIiLCJtc2ciLCJpbmRleCIsImluZGV4T2YiLCJzcGxpY2UiLCIkIiwiZWFjaCIsImkiLCJjb250ZW50IiwiaHRtbCIsImxvZ2luX2NvbnRyb2xsZXIiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwibG9naW4iLCJzaGEyNTYiLCIkaHR0cCIsImRhdGEiLCJwb3N0IiwicHV0IiwiZmFjdG9yeSIsImdldEFsbENvbnRlbnQiLCJwYWdlSWQiLCJtLXRva2VuIl0sIm1hcHBpbmdzIjoiQ0FBQSxXQUVBLFlBRUFBLFNBQUFDLE9BQUEsT0FBQSxVQUFBLGNBRUFDLFFBQUEsaUJBQUEsb0JBQUEsU0FBQUMsRUFBQUMsR0FDQUQsRUFDQUUsS0FBQSxLQUNBQyxZQUFBLG1DQUNBQyxXQUFBLHdCQUVBRixLQUFBLGNBQ0FDLFlBQUEscUNBQ0FDLFdBQUEsc0JBRUFGLEtBQUEsVUFDQUMsWUFBQSxnQ0FDQUMsV0FBQSxxQkFFQUYsS0FBQSxRQUNBQyxZQUFBLDhCQUNBQyxXQUFBLG1CQUVBQyxXQUFBQyxXQUFBLE1BRUFMLEVBQUFNLFdBQUEsU0MxQkEsV0FDQSxZQUVBLElBQUFDLEdBQUEsU0FBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FFQUosRUFBQUssYUFDQUwsRUFBQU0sZUFDQU4sRUFBQU8sV0FBQSxDQUdBLElBQUFDLEdBQUFQLEVBQUFRLElBQUEsVUFDQUQsSUFBQU4sRUFBQVEsS0FBQSxVQUNBRixHQUdBTCxFQUFBUSxrQkFBQUgsR0FBQUksS0FBQSxTQUFBQyxHQUVBQSxFQUFBQyxRQUVBQyxJQUdBRixFQUFBRyxPQUVBZCxFQUFBUSxLQUFBRyxFQUFBSSxlQUtBLElBQUFGLEdBQUEsV0FFQVgsRUFBQWMsa0JBQUEsR0FBQU4sS0FBQSxTQUFBQyxHQUVBYixFQUFBSyxVQUFBUSxJQUdBVCxFQUFBYyxrQkFBQSxHQUFBTixLQUFBLFNBQUFDLEdBRUFiLEVBQUFNLFlBQUFPLElBSUFiLEdBQUFtQixTQUFBLFNBQUFDLEdBQ0FBLEVBQUFDLElBQ0FqQixFQUFBa0IsdUJBQUFGLEVBQUFDLEdBQUFELEVBQUFHLE1BQUFYLEtBQUEs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QyxRQW9CQXpDLGtCQWhCQSxTQUFBOEMsR0FFQSxNQUFBTixHQUFBakQsSUFBQSxpQkFBQXVELEdBQUFwRCxLQUFBLFNBQUFDLEdBQ0EsTUFBQUEsR0FBQThDLFFBY0FyQyx1QkFWQSxTQUFBRCxFQUFBRSxHQUVBLE1BQUFtQyxHQUFBRSxLQUFBLGlCQUFBdkMsR0FBQUUsS0FBQUEsSUFBQVgsS0FBQSxTQUFBQyxHQUNBLE1BQUFBLEdBQUE4QyxTQVlBdkUsU0FBQUMsT0FBQSxPQUFBeUUsUUFBQSxlQUFBLFFBQUExRCxPQ2xDQSxXQUNBLFlBRUEsSUFBQUQsR0FBQSxTQUFBdUQsR0FnQkEsT0FDQUYsTUFmQSxTQUFBQSxFQUFBRCxHQUVBLE1BQUFHLEdBQUFFLEtBQUEsY0FBQUosTUFBQUEsRUFBQUQsU0FBQUEsSUFBQTNDLEtBQUEsU0FBQUMsR0FDQSxNQUFBQSxHQUFBOEMsUUFhQWhELGtCQVRBLFNBQUFILEdBRUEsTUFBQWtELEdBQUFFLEtBQUEsa0JBQUFLLFVBQUF6RCxJQUFBSSxLQUFBLFNBQUFDLEdBQ0EsTUFBQUEsR0FBQThDLFNBV0F2RSxTQUFBQyxPQUFBLE9BQUF5RSxRQUFBLGdCQUFBLFFBQUEzRCIsImZpbGUiOiJzY3JpcHQubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7XG5cbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKFwiYXBwXCIsIFtcIm5nUm91dGVcIiwgXCJuZ0Nvb2tpZXNcIl0pO1xuXG4gIGFwcC5jb25maWcoW1wiJHJvdXRlUHJvdmlkZXJcIiwgXCIkbG9jYXRpb25Qcm92aWRlclwiLCBmdW5jdGlvbigkcm91dGVQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIpIHtcbiAgICAkcm91dGVQcm92aWRlclxuICAgICAgLndoZW4oJy8nLCB7XG4gICAgICAgIHRlbXBsYXRlVXJsOiBcInZpZXdzL3B1YmxpYy9wYWdlcy9saXN0cGFnZS5odG1sXCIsXG4gICAgICAgIGNvbnRyb2xsZXI6IFwibGlzdHBhZ2VfY29udHJvbGxlclwiXG4gICAgICB9KVxuICAgICAgLndoZW4oJy9iZWFycy86aWQnLCB7XG4gICAgICAgIHRlbXBsYXRlVXJsOiBcInZpZXdzL3B1YmxpYy9wYWdlcy9kZXRhaWxwYWdlLmh0bWxcIixcbiAgICAgICAgY29udHJvbGxlcjogXCJkZXRhaWxfY29udHJvbGxlclwiXG4gICAgICB9KVxuICAgICAgLndoZW4oJy9sb2dpbicsIHtcbiAgICAgICAgdGVtcGxhdGVVcmw6IFwidmlld3MvcHVibGljL3BhZ2VzL2xvZ2luLmh0bWxcIixcbiAgICAgICAgY29udHJvbGxlcjogXCJsb2dpbl9jb250cm9sbGVyXCJcbiAgICAgIH0pXG4gICAgICAud2hlbignL2NtcycsIHtcbiAgICAgICAgdGVtcGxhdGVVcmw6IFwidmlld3MvcHVibGljL3BhZ2VzL2Ntcy5odG1sXCIsXG4gICAgICAgIGNvbnRyb2xsZXI6IFwiY21zX2NvbnRyb2xsZXJcIlxuICAgICAgfSlcbiAgICAgIC5vdGhlcndpc2Uoe3JlZGlyZWN0VG86IFwiL1wifSk7XG5cbiAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XG4gIH1dKTtcblxufSkoKTtcbiIsIihmdW5jdGlvbigpe1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgY21zX2NvbnRyb2xsZXIgPSBmdW5jdGlvbigkc2NvcGUsICRjb29raWVzLCAkbG9jYXRpb24sIHVzZXJfc2VydmljZSwgY21zX3NlcnZpY2UpIHtcblxuICAgICRzY29wZS5ob21lVGV4dHMgPSBbXTtcbiAgICAkc2NvcGUuZGV0YWlsVGV4dHMgPSBbXTtcbiAgICAkc2NvcGUuc2hvd0lucHV0ID0gZmFsc2U7XG5cbiAgICAvLyBjaGVjayBmb3IgdmFsaWQgdG9rZW5cbiAgICB2YXIgdG9rZW4gPSAkY29va2llcy5nZXQoXCJtLXRva2VuXCIpO1xuICAgIGlmICghdG9rZW4pICRsb2NhdGlvbi5wYXRoKCcvbG9naW4nKTtcbiAgICBpZiAodG9rZW4pIHtcblxuICAgICAgLy8gY2hlY2sgaWYgdGhpcyB0b2tlbiBpcyBsZWdpdFxuICAgICAgdXNlcl9zZXJ2aWNlLmF1dGhlbnRpY2F0ZVRva2VuKHRva2VuKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cbiAgICAgICAgaWYgKHJlc3BvbnNlLnN1Y2Nlc3MpIHtcbiAgICAgICAgICAvLyBnZXQgYWxsIHRleHQgY29udGVudD8gb3IgcGVyIHBhZ2U/XG4gICAgICAgICAgaW5pdCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgZWxzZSBpZiAocmVzcG9uc2UuZXJyb3IpIHtcbiAgICAgICAgICAvLyByZWRpcmVjdFxuICAgICAgICAgICRsb2NhdGlvbi5wYXRoKHJlc3BvbnNlLnJlZGlyZWN0X3VybCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHZhciBpbml0ID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgIGNtc19zZXJ2aWNlLmdldENvbnRlbnRGb3JQYWdlKDEpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcblxuICAgICAgICAkc2NvcGUuaG9tZVRleHRzID0gcmVzcG9uc2U7XG4gICAgICB9KTtcblxuICAgICAgY21zX3NlcnZpY2UuZ2V0Q29udGVudEZvclBhZ2UoMikudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuXG4gICAgICAgICRzY29wZS5kZXRhaWxUZXh0cyA9IHJlc3BvbnNlO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgICRzY29wZS5zYXZlVGV4dCA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgIGlmICghdC5pZCkgcmV0dXJuO1xuICAgICAgY21zX3NlcnZpY2UudXBkYXRlQ29udGVudEZvclRleHRJZCh0LmlkLCB0LnRleHQpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgfSk7XG4gICAgfTtcblxuICB9O1xuXG4gIGFuZ3VsYXIubW9kdWxlKFwiYXBwXCIpLmNvbnRyb2xsZXIoXCJjbXNfY29udHJvbGxlclwiLCBbXCIkc2NvcGVcIiwgXCIkY29va2llc1wiLCBcIiRsb2NhdGlvblwiLCBcInVzZXJfc2VydmljZVwiLCBcImNtc19zZXJ2aWNlXCIsIGNtc19jb250cm9sbGVyXSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCl7XG5cbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIGNyZWF0ZV9jb250cm9sbGVyID0gZnVuY3Rpb24oJHNjb3BlLCBiZWFyX3NlcnZpY2UpIHtcblxuICAgICRzY29wZS5uZXdCZWFyID0ge1xuICAgICAgbmFtZTogJycsXG4gICAgICBob21lOiAnJ1xuICAgIH07XG5cbiAgICAkc2NvcGUuY3JlYXRlQmVhciA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICBpZiAoJHNjb3BlLm5ld0JlYXIubmFtZSAmJiAkc2NvcGUubmV3QmVhci5ob21lKSB7XG4gICAgICAgIGJlYXJfc2VydmljZS5jcmVhdGVfYmVhcigkc2NvcGUubmV3QmVhcikudGhlbihmdW5jdGlvbihiZWFyKSB7XG5cbiAgICAgICAgICBpZiAoYmVhci5pZCAmJiBiZWFyLm5hbWUgJiYgYmVhci5ob21lKSB7XG4gICAgICAgICAgICAkc2NvcGUuYmVhcnMucHVzaChiZWFyKTtcbiAgICAgICAgICAgICRzY29wZS5uZXdCZWFyID0ge25hbWU6ICcnLCBob21lOiAnJ307XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICB9O1xuXG4gIGFuZ3VsYXIubW9kdWxlKFwiYXBwXCIpLmNvbnRyb2xsZXIoXCJjcmVhdGVfY29udHJvbGxlclwiLCBbXCIkc2NvcGVcIiwgXCJiZWFyX3NlcnZpY2VcIiwgY3JlYXRlX2NvbnRyb2xsZXJdKTtcblxufSkoKTtcbiIsIihmdW5jdGlvbigpe1xuXG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBkZXRhaWxfY29udHJvbGxlciA9IGZ1bmN0aW9uKCRzY29wZSwgJHJvdXRlUGFyYW1zLCBiZWFyX3NlcnZpY2UpIHtcblxuXG4gICAgYmVhcl9zZXJ2aWNlLmdldF9iZWFyX2J5X2lkKCRyb3V0ZVBhcmFtcy5pZCkudGhlbihmdW5jdGlvbihiZWFyKSB7XG5cbiAgICAgICRzY29wZS5jdXJyZW50QmVhciA9IGJlYXI7XG4gICAgfSk7XG4gIH07XG5cbiAgIGFuZ3VsYXIubW9kdWxlKFwiYXBwXCIpLmNvbnRyb2xsZXIoXCJkZXRhaWxfY29udHJvbGxlclwiLCBbXCIkc2NvcGVcIiwgXCIkcm91dGVQYXJhbXNcIiwgXCJiZWFyX3NlcnZpY2VcIiwgZGV0YWlsX2NvbnRyb2xsZXJdKTtcblxufSkoKTtcbiIsIihmdW5jdGlvbigpe1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgbGlzdHBhZ2VfY29udHJvbGxlciA9IGZ1bmN0aW9uKCRzY29wZSwgYmVhcl9zZXJ2aWNlLCBjbXNfc2VydmljZSkge1xuXG5cbiAgICAkc2NvcGUuYmVhcnMgPSBbXTtcblxuICAgIGJlYXJfc2VydmljZS5nZXRfYmVhcnMoKS50aGVuKGZ1bmN0aW9uKGJlYXJzKSB7XG4gICAgICAkc2NvcGUuYmVhcnMgPSBiZWFycztcbiAgICB9KTtcblxuICAgICRzY29wZS5kZWxldGVCZWFyID0gZnVuY3Rpb24oYmVhcikge1xuICAgICAgYmVhcl9zZXJ2aWNlLmRlbGV0ZV9iZWFyKGJlYXIuaWQpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcblxuICAgICAgICBpZiAocmVzcG9uc2UubXNnID09PSBcInN1Y2Nlc3NcIikge1xuICAgICAgICAgIHZhciBpbmRleCA9ICRzY29wZS5iZWFycy5pbmRleE9mKGJlYXIpO1xuXG5cbiAgICAgICAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgICAgICAgJHNjb3BlLmJlYXJzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgY21zX3NlcnZpY2UuZ2V0Q29udGVudEZvclBhZ2UoMSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgXG4gICAgICAkLmVhY2gocmVzcG9uc2UsIGZ1bmN0aW9uKGksIGNvbnRlbnQpIHtcbiAgICAgICAgJCgnW2RhdGEtdC1pZD1cIicgKyBjb250ZW50LmlkICArJ1wiXScpLmh0bWwoY29udGVudC50ZXh0KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gIH07XG5cbiAgYW5ndWxhci5tb2R1bGUoXCJhcHBcIikuY29udHJvbGxlcihcImxpc3RwYWdlX2NvbnRyb2xsZXJcIiwgW1wiJHNjb3BlXCIsIFwiYmVhcl9zZXJ2aWNlXCIsIFwiY21zX3NlcnZpY2VcIiwgbGlzdHBhZ2VfY29udHJvbGxlcl0pO1xufSkoKTtcbiIsIihmdW5jdGlvbigpe1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgbG9naW5fY29udHJvbGxlciA9IGZ1bmN0aW9uKCRzY29wZSwgJGxvY2F0aW9uLCB1c2VyX3NlcnZpY2UpIHtcblxuICAgICRzY29wZS51c2VybmFtZSA9IFwibWFyaWpuXCI7XG4gICAgJHNjb3BlLnBhc3N3b3JkID0gXCIxMjM0NVwiO1xuXG4gICAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgIHVzZXJfc2VydmljZS5sb2dpbigkc2NvcGUudXNlcm5hbWUsIHNoYTI1Nigkc2NvcGUucGFzc3dvcmQpKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cbiAgICAgICAgJGxvY2F0aW9uLnBhdGgocmVzcG9uc2UucmVkaXJlY3RfdXJsKTtcbiAgICAgIH0pO1xuICAgIH07XG4gIH07XG5cbiAgYW5ndWxhci5tb2R1bGUoXCJhcHBcIikuY29udHJvbGxlcihcImxvZ2luX2NvbnRyb2xsZXJcIiwgW1wiJHNjb3BlXCIsIFwiJGxvY2F0aW9uXCIsIFwidXNlcl9zZXJ2aWNlXCIsIGxvZ2luX2NvbnRyb2xsZXJdKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKXtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIGJlYXJfc2VydmljZSA9IGZ1bmN0aW9uKCRodHRwKSB7XG5cbiAgICBcbiAgICB2YXIgZ2V0X2JlYXJzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2JlYXJzJykudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICB2YXIgZ2V0X2JlYXJfYnlfaWQgPSBmdW5jdGlvbihpZCkge1xuXG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2JlYXJzLycgKyBpZCkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICAgIH0pO1xuXG4gICAgfTtcblxuICAgIHZhciBjcmVhdGVfYmVhciA9IGZ1bmN0aW9uKGJlYXIpIHtcbiAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL2JlYXJzJywgYmVhcikudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICB2YXIgZGVsZXRlX2JlYXIgPSBmdW5jdGlvbihpZCkge1xuICAgICAgcmV0dXJuICRodHRwLnB1dCgnL2FwaS9iZWFycy8nICsgaWQpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGdldF9iZWFyczogZ2V0X2JlYXJzLFxuICAgICAgZ2V0X2JlYXJfYnlfaWQ6IGdldF9iZWFyX2J5X2lkLFxuICAgICAgY3JlYXRlX2JlYXI6IGNyZWF0ZV9iZWFyLFxuICAgICAgZGVsZXRlX2JlYXI6IGRlbGV0ZV9iZWFyXG4gICAgfTtcblxuICB9O1xuXG4gICBhbmd1bGFyLm1vZHVsZShcImFwcFwiKS5mYWN0b3J5KFwiYmVhcl9zZXJ2aWNlXCIsIFtcIiRodHRwXCIsIGJlYXJfc2VydmljZV0pO1xuXG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKXtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIGNtc19zZXJ2aWNlID0gZnVuY3Rpb24oJGh0dHApIHtcblxuICAgIHZhciBnZXRBbGxDb250ZW50ID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvY21zL3BhZ2VzJykudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICB2YXIgZ2V0Q29udGVudEZvclBhZ2UgPSBmdW5jdGlvbihwYWdlSWQpIHtcblxuICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9jbXMvcGFnZS8nICsgcGFnZUlkKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG4gICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIHZhciB1cGRhdGVDb250ZW50Rm9yVGV4dElkID0gZnVuY3Rpb24oaWQsIHRleHQpIHtcblxuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvY21zL3BhZ2UvJyArIGlkLCB7XCJ0ZXh0XCI6IHRleHR9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICAgIH0pO1xuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgZ2V0QWxsQ29udGVudDogZ2V0QWxsQ29udGVudCxcbiAgICAgIGdldENvbnRlbnRGb3JQYWdlOiBnZXRDb250ZW50Rm9yUGFnZSxcbiAgICAgIHVwZGF0ZUNvbnRlbnRGb3JUZXh0SWQ6IHVwZGF0ZUNvbnRlbnRGb3JUZXh0SWRcbiAgICB9O1xuXG4gIH07XG5cbiAgIGFuZ3VsYXIubW9kdWxlKFwiYXBwXCIpLmZhY3RvcnkoXCJjbXNfc2VydmljZVwiLCBbXCIkaHR0cFwiLCBjbXNfc2VydmljZV0pO1xuXG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKXtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIHVzZXJfc2VydmljZSA9IGZ1bmN0aW9uKCRodHRwKSB7XG5cbiAgICB2YXIgbG9naW4gPSBmdW5jdGlvbihsb2dpbiwgcGFzc3dvcmQpIHtcblxuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvbG9naW4nLCB7XCJsb2dpblwiOiBsb2dpbiwgXCJwYXNzd29yZFwiOiBwYXNzd29yZH0pLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgdmFyIGF1dGhlbnRpY2F0ZVRva2VuID0gZnVuY3Rpb24odG9rZW4pIHtcblxuICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvYXV0aHRva2VuJywge1wibS10b2tlblwiOiB0b2tlbn0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIHJldHVybiB7XG4gICAgICBsb2dpbjogbG9naW4sXG4gICAgICBhdXRoZW50aWNhdGVUb2tlbjogYXV0aGVudGljYXRlVG9rZW5cbiAgICB9O1xuXG4gIH07XG5cbiAgIGFuZ3VsYXIubW9kdWxlKFwiYXBwXCIpLmZhY3RvcnkoXCJ1c2VyX3NlcnZpY2VcIiwgW1wiJGh0dHBcIiwgdXNlcl9zZXJ2aWNlXSk7XG5cblxufSkoKTtcbiJdfQ==
